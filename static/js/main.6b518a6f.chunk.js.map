{"version":3,"sources":["input/Mouse.js","input/Keyboard.js","input/Touch.js","Canvas2d.js","Canvas3d.js","MaurerRose.js","Scene.js","Explorer.js","App.js","serviceWorker.js","index.js"],"names":["Mouse","scene","bind","ref","addEventListener","handleMouseWheel","handleMouseDown","handleMouseUp","handleMouseMove","handleMouseOut","unbind","removeEventListener","e","isMouseDown","zoom","deltaY","updateZoom","lastDragCoords","pageX","pageY","preventDefault","dX","width","aspect","y","dY","height","x","translate","this","Keyboard","window","handleKeyDown","shiftX","tile","shiftY","keyCode","Touch","handleTouchMove","handleTouchStart","handleTouchEnd","handleTouchCancel","events","length","lastTouchCoords","changedTouches","i","identifier","curDist","Math","sqrt","pow","clientX","clientY","prevDist","timesince","Date","getTime","lastTouchTime","push","prevDistance","AXIS_SIZE","AXIS_BACKGROUND","Overlay","initialize","canvas","a","ctx","getContext","Promise","reject","resolve","draw","clearRect","drawLegend","update","center","centerX","centerY","size","pixelWidth","pixelHeight","xAxis","start","floor","label","yAxis","drawScene","fillStyle","fillRect","save","beginPath","font","textAlign","textBaseline","yLabel","fillText","moveTo","lineTo","xLabel","closePath","lineWidth","strokeStyle","stroke","restore","Canvas3d","createBuffer","gl","createIndexBuffer","indices","dynamic","buffer","bindBuffer","ELEMENT_ARRAY_BUFFER","bufferData","Uint16Array","DYNAMIC_DRAW","STATIC_DRAW","updateBuffer","data","ARRAY_BUFFER","Float32Array","vertShader","createShader","VERTEX_SHADER","shaderSource","compileShader","fragShader","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","useProgram","attrCoord","getAttribLocation","attrColor","attrTranslation","getUniformLocation","uniformScaleMatrix","program","objects","objects3d","uniformSize","xCenter","yCenter","x1","y1","ceil","x2","y2","have","Array","abs","avail","ai","compute","viewport","clearColor","clear","COLOR_BUFFER_BIT","disable","DEPTH_TEST","enable","DITHER","flatMap","object","shapes","forEach","shape","drawShape","glObject","colorBuffer","vertexAttribPointer","FLOAT","enableVertexAttribArray","disableVertexAttribArray","vertexBuffer","indexBuffer","scaleFnc","uniformMatrix4fv","tx","translateFnc","uniform4f","style","POINTS","styleName","LINE_LOOP","LINE_STRIP","LINES","TRIANGLES","drawElements","UNSIGNED_SHORT","offset","drawArrays","MaurerRose","n","d","tX","tY","vertices","v","z","createScaleMatrix","t","sX","sY","ofsetX","ofsetY","points","index","theta","k","PI","r","sin","cos","state","SCALE_1_COUNT","Scene","refCanvas2d","refCanvas3d","canvas3d","then","canvas2d","Rose","updateSize","max","c","requestAnimationFrame","redraw","Canvas2d","Explorer","props","handleResize","resizeTimeout","clearTimeout","setTimeout","updateDimensions","updateCanvasSize","innerWidth","innerHeight","setState","chromeWorkaround","refs","input","keyboard","touch","mouse","initialized","error","catch","classes","AppBar","position","className","appBar","Toolbar","Link","title","variant","underline","component","href","target","color","CircularProgress","progress","disableShrink","thickness","Typography","display","gutterBottom","paragraph","align","container","help","Component","withStyles","theme","left","top","zIndex","backgroundColor","padding","spacing","bottom","right","borderRadius","fontSize","fontWeight","marginLeft","App","Fragment","CssBaseline","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.6b518a6f.chunk.js","sourcesContent":["        \nexport default class Mouse {\n\n    constructor(scene) {\n        this.scene = scene;\n    }\n    \n    bind = (ref) => {\n        this.ref = ref;\n        \n        ref.addEventListener(\"wheel\", this.handleMouseWheel, false);\n        ref.addEventListener(\"mousedown\", this.handleMouseDown, false);\n        ref.addEventListener(\"mouseup\", this.handleMouseUp, false);\n        ref.addEventListener(\"mousemove\", this.handleMouseMove, false);\n        ref.addEventListener(\"mouseout\", this.handleMouseOut, false);\n    }\n    \n    unbind = () => {\n        if (!this.ref) {\n            return;\n        }\n        \n        this.ref.removeEventListener(\"wheel\", this.handleMouseWheel);\n        this.ref.removeEventListener(\"mousedown\", this.handleMouseDown);\n        this.ref.removeEventListener(\"mouseup\", this.handleMouseUp);\n        this.ref.removeEventListener(\"mousemove\", this.handleMouseMove);\n        this.ref.removeEventListener(\"mouseout\", this.handleMouseOut);        \n    }\n        \n    handleMouseWheel = e => {\n        \n        this.isMouseDown = false;\n        \n        let zoom = this.scene.zoom;\n        \n        if (e.deltaY < 0) {\n            zoom -= 0.1             \n        } else if (e.deltaY > 0) {\n            zoom += 0.1             \n        }\n        \n        if (zoom < 0.5) {\n            zoom = 0.5;\n        }\n        \n        this.scene.updateZoom(zoom);\n        \n        return false;\n    }\n        \n    handleMouseDown = e => {\n        if (this.isMouseDown) {\n            this.isMouseDown = false;\n            \n        } else {\n            this.lastDragCoords = [e.pageX, e.pageY];\n            this.isMouseDown = true;\n        }\n\n        e.preventDefault();\n        return false;\n    }\n\n    handleMouseUp = e => {\n        this.isMouseDown = false;\n        \n        e.preventDefault();\n        return false;\n    }\n\n    handleMouseMove = e => {\n        if (this.isMouseDown) {\n            \n            const dX = ((e.pageX - this.lastDragCoords[0]) / (this.scene.width * this.scene.aspect.y) * 3) / this.scene.zoom;\n            const dY = -1*((e.pageY - this.lastDragCoords[1]) / (this.scene.height* this.scene.aspect.x) * 3) / this.scene.zoom;\n\n            this.lastDragCoords = [e.pageX, e.pageY];\n\n            this.scene.translate(dX, dY);\n            \n            e.preventDefault();\n            return false;\n        }\n    }\n    \n    handleMouseOut = e => {\n        this.isMouseDown = false;\n    }\n}","        \nexport default class Keyboard {\n\n    constructor(scene) {\n        this.scene = scene;\n    }\n    \n    bind = (ref) => {\n        this.ref = ref;\n        \n        window.addEventListener(\"keydown\", this.handleKeyDown);            \n    }\n    \n    unbind = () => {\n        if (!this.ref) {\n            return;\n        }\n        \n        window.removeEventListener(\"keydown\", this.handleKeyDown);\n    }\n            \n    handleKeyDown = (e) => {\n\n        const shiftX = this.scene.tile.width  / (2 * this.scene.zoom);\n        const shiftY = this.scene.tile.height / (2 * this.scene.zoom);\n\n        // down\n        if (e.keyCode === 38) {\n            this.scene.translate(0, shiftY);\n            \n        // up\n        } else if (e.keyCode === 40) {\n            this.scene.translate(0, -shiftY);\n            \n        // left\n        } else if (e.keyCode === 37) {\n            this.scene.translate(-shiftX, 0);\n            \n        } else if (e.keyCode === 39) {\n            this.scene.translate(shiftX, 0);            \n        }\n    }    \n}","        \nexport default class Touch {\n\n    constructor(scene) {\n        this.scene = scene;\n        \n        this.events = [];\n        \n        this.prevDistance = -1;\n        \n        this.lastTouchTime = 0;\n    }\n    \n    bind = (ref) => {\n        this.ref = ref;\n\n        this.ref.addEventListener(\"touchmove\", this.handleTouchMove, false);\n        this.ref.addEventListener(\"touchstart\", this.handleTouchStart, false);\n        this.ref.addEventListener(\"touchend\", this.handleTouchEnd, false);\n        this.ref.addEventListener(\"touchcancel\", this.handleTouchCancel, false);\n    }\n    \n    unbind = () => {\n        if (!this.ref) {\n            return;\n        }\n        this.ref.removeEventListener(\"touchcancel\", this.handleTouchMove);\n        this.ref.removeEventListener(\"touchend\", this.handleTouchEnd);\n        this.ref.removeEventListener(\"touchstart\", this.handleTouchStart);\n        this.ref.removeEventListener(\"touchmove\", this.handleTouchMove);        \n    }\n    \n    handleTouchMove = e => {\n\n        if (this.events.length === 1) {\n            if (this.lastTouchCoords) {\n                const dX = ((e.changedTouches[0].pageX-this.lastTouchCoords[0]) / (this.scene.width * this.scene.aspect.y) * 3) / this.scene.zoom;\n                const dY = -1*((e.changedTouches[0].pageY-this.lastTouchCoords[1]) / (this.scene.height* this.scene.aspect.x) * 3) / this.scene.zoom;\n\n                this.scene.translate(dX, dY);\n            }                        \n            this.lastTouchCoords = [e.changedTouches[0].pageX, e.changedTouches[0].pageY];\n\n        } else if (this.events.length === 2) {\n            \n            for (let i = 0; i < this.events.length; i++) {\n\n                if (e.changedTouches[0].identifier === this.events[i].changedTouches[0].identifier) {\n                    this.events[i] = e;\n                    break;\n                }\n            }\n            \n                    const curDist = Math.sqrt(\n                                    Math.pow(\n                                        this.events[0].changedTouches[0].clientX - this.events[1].changedTouches[0].clientX,\n                                        2\n                                    )\n                                    +\n                                    Math.pow(\n                                        this.events[0].changedTouches[0].clientY - this.events[1].changedTouches[0].clientY,\n                                        2                                        \n                                    )\n                                );\n\n                    let zoom = this.scene.zoom;\n        \n                    if (this.prevDist > 0) {\n        \n                        if (curDist > this.prevDist) {\n                            zoom += (0.04 * zoom);\n                        }\n                        if (curDist < this.prevDist) {\n                            zoom -= (0.04  * zoom);\n                        }\n                if (zoom < 0.5) {\n                    zoom = 0.5;\n                }\n                \n                this.scene.updateZoom(zoom);\n            }\n            this.prevDist = curDist;\n        }\n        e.preventDefault();\n        return false;\n        \n    }\n    \n    handleTouchStart = (e) => {\n                \n        if (this.events.length === 0) {\n            \n            const now = new Date().getTime();\n            const timesince = now - this.lastTouchTime;\n            \n            if ((timesince < 300) && (timesince > 0)){\n                let zoom = this.scene.zoom;\n\n                zoom += (0.5  * zoom);\n\n                if (zoom < 0.5) {\n                    zoom = 0.5;\n                }\n                this.scene.updateZoom(zoom);\n      \n                this.lastTouchTime = 0;\n                                \n                e.preventDefault();\n                return false;\n            }\n            \n            this.lastTouchCoords = [e.changedTouches[0].pageX, e.changedTouches[0].pageY];\n            this.lastTouchTime = new Date().getTime() \n            this.events.push(e);\n\n        } else if (this.events.length === 1) {\n            this.events.push(e);\n        }\n\n        e.preventDefault();\n        return false;        \n    }\n    \n    handleTouchEnd = (e) => {\n        this.events = [];\n        this.lastTouchCoords = null;\n        this.prevDist = -1;\n        e.preventDefault();\n        return false;\n    }\n\n    handleTouchCancel = (e) => {\n        this.events = [];\n        this.lastTouchCoords = null;\n        this.prevDist = -1;\n        this.lastTouchTime = 0;\n    }    \n}","\nconst AXIS_SIZE = 40;\nconst AXIS_BACKGROUND = '#dadadaff';\nconst AXIS_FONT_COLOR = '#3a3a3aff';\nconst AXIS_DELIMITER_COLOR = '#ffffffff';\n\nexport default class Overlay {\n    \n    initialize = async (canvas) => {\n     \n        const ctx = canvas.getContext(\"2d\")\n                \n        if (!ctx) {\n            return Promise.reject(\"2d canvas is not supported by your browser.\");\n        }\n        this.ctx = ctx;\n        \n        return Promise.resolve();        \n    }\n    \n    draw = () => {\n        this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height); \n        this.drawLegend();\n    }\n    \n    update = ({aspect, center, zoom, tile, width, height}) => {\n\n//console.log(\"overlay\", \"update\", aspect, center, zoom);\n        const centerX = width / 2 + width * aspect.y * zoom * (center.x / 2);\n        const centerY = height / 2 - height * aspect.x * zoom * (center.y / 2);\n        \n        const size = aspect.y === 1 ? tile.pixelWidth : tile.pixelHeight;\n                           \n        this.xAxis = {\n                start: ((centerX / size) - Math.floor(centerX / size)) * size,\n                label: -1*Math.floor(centerX / size),                \n                size: size \n                }; \n\n        this.yAxis = {\n                start: ((centerY / size) - Math.floor(centerY / size)) * size,\n                label: -1*Math.floor(centerY / size),                \n                size: size  \n                }; \n    }\n                \n\n    drawScene = () => {\n  //      console.log(\"axis\", this.xAxis, this.yAxis);\n        if (!this.xAxis || !this.yAxis) {\n            return;\n        }\n        \n        this.ctx.fillStyle = AXIS_BACKGROUND;        \n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, AXIS_SIZE);        \n        this.ctx.fillRect(0, 0, AXIS_SIZE, this.ctx.canvas.height);\n\n        this.ctx.save();\n        this.ctx.beginPath();\n        this.ctx.fillStyle = AXIS_FONT_COLOR;        \n        this.ctx.font = '300 13px sans-serif'\n        this.ctx.textAlign = 'center';\n        this.ctx.textBaseline = 'middle';\n\n        let yLabel = this.yAxis.label;\n        \n        this.ctx.fillText(yLabel-1, AXIS_SIZE / 2,  this.yAxis.start - this.yAxis.size / 2 );\n        \n        // y Axis        \n        for (let y=this.yAxis.start; y < this.ctx.canvas.height; y += this.yAxis.size) {\n            \n            this.ctx.fillText(yLabel++, AXIS_SIZE / 2,  y + this.yAxis.size / 2 );\n            \n            this.ctx.moveTo(0,  y);\n            this.ctx.lineTo(AXIS_SIZE, y);\n        }\n        \n        let xLabel = this.xAxis.label;\n        \n        this.ctx.fillText(xLabel-1, this.xAxis.start - this.xAxis.size / 2, AXIS_SIZE / 2);\n\n        // x Axis        \n        for (let x=this.xAxis.start; x < this.ctx.canvas.width; x += this.xAxis.size) {\n                        \n            this.ctx.fillText(xLabel++, x + this.xAxis.size / 2, AXIS_SIZE / 2);\n            \n            this.ctx.moveTo(x, 0);\n            this.ctx.lineTo(x, AXIS_SIZE);\n        }\n        \n        this.ctx.closePath();\n        \n        this.ctx.lineWidth = 1.0;\n        this.ctx.strokeStyle = AXIS_DELIMITER_COLOR;\n        this.ctx.stroke();\n        this.ctx.restore();\n\n        this.ctx.fillStyle = AXIS_BACKGROUND;        \n        this.ctx.fillRect(0, 0, AXIS_SIZE, AXIS_SIZE);\n        \n        this.ctx.strokeStyle = '#eaeaeaff';\n        this.ctx.beginPath();\n        this.ctx.lineWidth = 2;\n\n        this.ctx.moveTo(AXIS_SIZE - 1, 0);\n        this.ctx.lineTo(AXIS_SIZE - 1, AXIS_SIZE - 1);\n        this.ctx.moveTo(0, AXIS_SIZE - 1);\n        this.ctx.lineTo(AXIS_SIZE - 1, AXIS_SIZE - 1);\n\n        this.ctx.moveTo(AXIS_SIZE - 1, AXIS_SIZE - 1);\n        this.ctx.lineTo(AXIS_SIZE - 1, this.ctx.canvas.height);\n        this.ctx.moveTo(AXIS_SIZE - 1, AXIS_SIZE - 1);\n        this.ctx.lineTo(this.ctx.canvas.width, AXIS_SIZE - 1);        \n        this.ctx.closePath();        \n        this.ctx.stroke();\n    }\n    \n    drawLegend = (length = 70) => {\n        this.ctx.save();\n        this.ctx.translate(this.ctx.canvas.width - length - 5, this.ctx.canvas.height - length - 5);\n        \n        this.ctx.fillStyle = '#666666aa';\n        \n        this.ctx.fillRect(0, 0, length, length);        \n\n        this.ctx.beginPath();\n        \n        this.ctx.moveTo(length / 3, 5);\n        this.ctx.lineTo(length / 3, length - 5);\n        this.ctx.lineTo(length / 3 - 4, length - length / 8 - 5);\n        this.ctx.moveTo(length / 3, length - 5);\n        this.ctx.lineTo(length / 3 + 4, length - length / 8 - 5);\n\n        this.ctx.moveTo(5, length / 3);\n        this.ctx.lineTo(length - 5, length / 3);\n        this.ctx.lineTo(length - length / 8 - 5, length / 3 - 4);\n        this.ctx.moveTo(length - 5, length / 3);\n        this.ctx.lineTo(length - length / 8 - 5, length / 3 + 4);\n\n        this.ctx.moveTo(0, 0);\n        this.ctx.lineTo(0, length);\n        this.ctx.lineTo(length, length);\n        this.ctx.lineTo(length, 0);\n        this.ctx.lineTo(0, 0);\n        \n        this.ctx.closePath();\n        \n        this.ctx.lineWidth = 1;\n        this.ctx.strokeStyle = '#ffffffff';        \n        \n        this.ctx.stroke();\n        \n        this.ctx.font = '300 14px Roboto'\n        this.ctx.fillStyle = '#357a38';\n\n        this.ctx.fillStyle = '#ffffffff';\n        \n        this.ctx.textAlign = 'left';\n        this.ctx.fillText(\"d\", length / 3 + 7,  length - 7);\n        this.ctx.textAlign = 'right';\n        this.ctx.fillText(\"n\", length - 7, length / 3 - 7);\n        \n        this.ctx.restore();\n    }\n}","\n \n\nexport default class Canvas3d {\n        \n    createBuffer = () => {\n        // Create a new vertext buffer object\n        const buffer = this.gl.createBuffer();\n\n        return buffer;\n    }\n    \n    createIndexBuffer = (indices, dynamic=false) => {\n        const buffer = this.gl.createBuffer();\n        \n        this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, buffer);\n        this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), dynamic ? this.gl.DYNAMIC_DRAW : this.gl.STATIC_DRAW);\n        this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, null);\n        \n        return buffer;\n    }\n    \n    updateBuffer = (buffer, data, dynamic=false) => {\n\n        //Bind vertex buffer object\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, buffer);\n\n        // Pass the vertices data to the buffer\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array(data), dynamic ? this.gl.DYNAMIC_DRAW : this.gl.STATIC_DRAW);\n\n        // Unbind\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, null);        \n    }\n    \n\n    initialize = async (canvas) => {\n     \n        const gl = canvas.getContext(\"webgl\")\n                \n        if (!gl) {\n            return Promise.reject(\"WebGL is not supported by your browser.\");\n        }\n                                \n        // Vertex shader source code\n        const vertCode =\n            'attribute vec2 coordinates;'\n            + 'uniform mat4 scale;' \n            + 'uniform vec4 translation;'\n            + 'attribute vec3 color;'  \n            + 'varying vec3 vColor;' \n            + 'void main(void) {' \n            + ' gl_Position = scale * (vec4(coordinates, 0.0, 1.0) + translation) ; gl_PointSize = 5.0; vColor = color;' \n            + '}';\n\n        // Create a vertex shader object\n        let vertShader = gl.createShader(gl.VERTEX_SHADER);\n\n        // Attach vertex shader source code\n        gl.shaderSource(vertShader, vertCode);\n\n        // Compile the vertex shader\n        gl.compileShader(vertShader);\n\n        // Fragment shader source code\n        const fragCode =\n            'precision mediump float;'\n            + 'varying vec3 vColor;' \n            + 'void main(void) {' \n            + 'gl_FragColor = vec4(vColor, 1.);' \n            + '}';            \n//            'void main(void) {' + 'gl_FragColor = vec4(0.1, 0.1, 0.1, 1.);' + '}';\n\n        // Create fragment shader object\n        const fragShader = gl.createShader(gl.FRAGMENT_SHADER);\n\n        // Attach fragment shader source code\n        gl.shaderSource(fragShader, fragCode);\n\n        // Compile the fragment shader\n        gl.compileShader(fragShader);\n\n        // Create a shader program object to store combined shader program\n        const shaderProgram = gl.createProgram();\n\n        // Attach a vertex shader\n        gl.attachShader(shaderProgram, vertShader); \n         \n        // Attach a fragment shader\n        gl.attachShader(shaderProgram, fragShader);\n\n        // Link both programs\n        gl.linkProgram(shaderProgram);\n\n        // Use the combined shader program object\n        gl.useProgram(shaderProgram);\n\n        // Get the attribute location\n        this.attrCoord = gl.getAttribLocation(shaderProgram, \"coordinates\");\n\n        this.attrColor = gl.getAttribLocation(shaderProgram, \"color\");\n        \n        this.attrTranslation = gl.getUniformLocation(shaderProgram, 'translation');\n\n        this.uniformScaleMatrix = gl.getUniformLocation(shaderProgram, \"scale\");\n\n        this.gl = gl;   \n        this.program = shaderProgram;           \n        \n        return Promise.resolve();\n    }\n\n    //\n    update = ({aspect, center, zoom, tile, objects3d}) => {\n\n        const objects = objects3d;\n\n        const size =  tile.uniformSize;\n\n        const xCenter = -1*(center.x / size);\n        const yCenter = -1*(center.y / size);\n\n        const x1 =  Math.floor(xCenter - (1 / (size * zoom * aspect.y)));        \n        const y1 =  -1*Math.ceil(yCenter + (1 / (size * zoom * aspect.x)));\n\n        const x2 =  Math.floor(xCenter + (1 / (size * zoom * aspect.y)));\n        const y2 =  -1*Math.ceil(yCenter - (1 / (size * zoom * aspect.x)));\n        \n        \n//console.log(size*zoom, x1, y1, x2, y2);\n\n        const have = new Array(Math.abs(y2-y1)+1);\n        for (let y=0; y < have.length; y++) {\n            have[y] = new Array(Math.abs(x2-x1)+1)\n            for (let x=0; x < have[y].length; x++) {\n                have[y][x] = false;\n            }\n        }\n//let xx = 0\n        const avail = [];\n        for (let i in objects) {\n            if (!objects[i].x || !objects[i].y) {\n                avail.push(objects[i]);\n\n            } else if (objects[i].x >= x1 && objects[i].x <= x2 && objects[i].y >= y1 && objects[i].y <= y2) {\n                have[Math.abs(objects[i].y - y1)][Math.abs(objects[i].x - x1)] = true;\n  //              xx++;\n\n            } else {\n                avail.push(objects[i]);\n                objects[i].x = null;\n                objects[i].y = null;\n            }\n        }\n\n//console.log(\"objects\", objects.length, avail.length, xx);\n\n        let ai = 0;\n        for (let y=y1; y <= y2; y++) {\n\n            if (ai >= avail.length) {\n                break;\n            }\n            \n            for (let x=x1; x <= x2; x++) {\n//                console.log(x, y, x1, y1);\n                if (have[Math.abs(y-y1)][Math.abs(x-x1)]) {\n                    continue;\n                }\n                \n                (avail[ai]).compute(x, y, this);\n                \n                ai++;\n//                (avail[ai++]).update(aspect, center, zoom);\n                \n                if (ai >= avail.length) {\n                    break;\n                }\n                \n            }\n        }\n        //console.log(\"objects\", ai);\n    }\n\n    draw = () => {\n        \n        \n\n    }\n\n    // Draw the scene.    \n    drawScene = (objects, scene) => {\n\n\n        this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);\n\n\n        this.gl.useProgram(this.program);\n\n                // Clear the canvas\n        this.gl.clearColor(0.95, 0.95, 0.95, 1);\n\n        // Clear the color buffer bit\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n\n        this.gl.disable(this.gl.DEPTH_TEST);\n        this.gl.enable(this.gl.DITHER);\n\n//console.log(\"drawScene\", objects);\n//        time *= 0.0005;\n\n//        webglUtils.resizeCanvasToDisplaySize(gl.canvas);\n\n\n         \n\n//        console.log(this.uniformScaleMatrix);\n//        console.log(this.createScaleMatrix(aspect));\n        \n        \n        objects && objects.flatMap(object => object.shapes()).forEach(shape => this.drawShape(shape, scene));\n    }\n\n    drawShape = (glObject, {aspect, zoom, center}) => {\n\n//console.log(glObject.state);\n//        if (glObject.state !== 'new') {\n////            return;\n//        }\n//        \n//        glObject.state = 'drawn';\n\n//console.log(\"drawScene\",aspect, zoom, center);\n\n        if (glObject.colorBuffer) {\n            this.gl.bindBuffer(this.gl.ARRAY_BUFFER, glObject.colorBuffer);\n            \n            // point attribute to the volor buffer object\n            this.gl.vertexAttribPointer(this.attrColor, 3, this.gl.FLOAT, false,0,0) ;\n \n            // enable the color attribute\n            this.gl.enableVertexAttribArray(this.attrColor);\n\n        } else {\n\n            this.gl.disableVertexAttribArray(this.attrColor);\n        }\n\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, glObject.vertexBuffer);\n\n        if (glObject.indexBuffer) {\n              this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, glObject.indexBuffer);\n        }\n\n        // Point an attribute to the currently bound VBO\n        this.gl.vertexAttribPointer(this.attrCoord, 2, this.gl.FLOAT, false, 0, 0);\n\n        // Enable the attribute\n        this.gl.enableVertexAttribArray(this.attrCoord);\n\n        // Scale\n        if (glObject.scaleFnc) {\n            this.gl.uniformMatrix4fv(this.uniformScaleMatrix, false, glObject.scaleFnc(aspect, zoom));\n        }\n        \n//        console.log(\"xyz\", glObject.translateFnc(aspect, center));\n        \n        // Translace\n        const tx =  glObject.translateFnc ? glObject.translateFnc(aspect, center) : center;\n//        const tx = center;\n        this.gl.uniform4f(this.attrTranslation, tx.x, tx.y, 0.0, 0.0);\n\n        let style = this.gl.POINTS;\n        switch (glObject.styleName) {\n        case 'line-loop':\n            style = this.gl.LINE_LOOP;    \n            break;\n            \n        case 'line-strip':\n            style = this.gl.LINE_STRIP;    \n            break;\n\n        case 'lines':\n            style = this.gl.LINES;    \n            break;\n                \n        case 'triangles':\n            style = this.gl.TRIANGLES;\n            break;\n            \n        default:            \n        }                        \n\n        if (glObject.indexBuffer) {\n            this.gl.drawElements(style, glObject.length, this.gl.UNSIGNED_SHORT, glObject.offset);\n            \n        } else {\n            this.gl.drawArrays(style, glObject.offset, glObject.length);\n        }\n    }\n    \n}","\n\nexport default class MaurerRose {\n\t\n    constructor(width) {\n        this.width = width;    \n        this.buffer = null;  \n        this.state = 'empty';      \n    }\t\n        \n    bind = gl => {\n        this.buffer = gl.createBuffer();\n    }\n\n    compute = (n, d, gl) => {\n\n        this.x = n;\n        this.y = d;\n\n        this.tX = this.x * this.width + this.width / 2;\n        this.tY = -this.y * this.width - this.width / 2;\n\n        this.vertices = new Array(360);\n//        this.vertices.push(-this.width/2, this.width/2, this.width/2, this.width/2, this.width/2, -this.width/2, -this.width/2, -this.width/2);\n        \n        this.v(n, d, 0, 0, this.vertices, 0);        \n        gl.updateBuffer(this.buffer, this.vertices, true);                \n    }\n\n    shapes = () => {\n        if (!this.vertices || !this.x || !this.y ) {\n            return [];\n        }\n        \n        return [{\n                vertexBuffer:  this.buffer,\n                offset:   0,\n                length:   this.vertices.length / 2,\n                styleName:      'line-loop',\n                scaleFnc:       (a, z) => this.createScaleMatrix(a.y*z, a.x*z),\n                translateFnc:   (a, t) => this.translate(t),\n                }\n        ];\n    }\n    \n        \n    createScaleMatrix = (sX, sY) => {\n        \n        return new Float32Array([\n            sX,   0.0,  0.0,  0.0,\n            0.0,  sY,   0.0,  0.0,\n            0.0,  0.0,  1,   0.0,\n            0.0,  0.0,  0.0,  1.0  \n         ]);\n    }\n    \n    translate = t => {\n        return {\n                x: t.x + this.tX, \n                y: t.y + this.tY,  \n            };\n    }\n   \n    \n        v = (n = 4, d = 31, ofsetX = 0, ofsetY = 0, points, index) => {\n\n//console.log(n, d);        \n        \n        for (let theta=0; theta < 360; theta+=1) {\n\n            const k = theta * d * Math.PI / 180;\n            const r = 0.1 / 1  * Math.sin(n * k) ;\n            \n            const x = r * Math.cos(k);\n            const y = r * Math.sin(k);\n//    if (theta % 2 === 0) {\n            points[index + theta*2] = x   + ofsetX; \n            points[index + theta*2 + 1] = y   - ofsetY;        \n            }\n//        }\n//        console.log(v);\n        return index + 360 * 2;\n    }\n\n    \n}","\nimport Canvas2d from './Canvas2d';\nimport Canvas3d from './Canvas3d';\n\n\nimport Rose from './MaurerRose';\n\nconst SCALE_1_COUNT = 10;\n     \nexport default class Scene {\n\n    constructor() {\n        \n        this.zoom = 1;\n        \n        this.center = {\n            x: -5.12,\n            y: 2.69\n        };  \n            \n        this.aspect = {\n            x: 1,\n            y: 1,\n        }\n\n        this.tile = {\n            uniformSize: 2 / SCALE_1_COUNT,\n            width: 2 / (SCALE_1_COUNT * this.aspect.y),\n            height: 2 / (SCALE_1_COUNT * this.aspect.x),\n        };\n\n        this.objects3d = [];\n        \n        this.canvas3d = new Canvas3d();\n        this.canvas2d = new Canvas2d();\n        \n        this.canvas = [this.canvas2d, this.canvas3d];\n    }\n    \n    initialize = async (refCanvas2d, refCanvas3d) => {\n\n        return this.canvas3d.initialize(refCanvas3d).then(() => {\n            \n            return this.canvas2d.initialize(refCanvas2d);\n            \n        }).then(() => {\n\n            for (let y=0; y < 20; y++) {\n                for (let x=0; x < 20; x++) {                \n                    const object = new Rose(this.tile.uniformSize);\n                    \n                    object.bind(this.canvas3d);\n                    \n                    this.objects3d.push(object);\n                }\n            }\n        });\n    }\n    \n    updateSize = (width, height) => {\n        \n        this.width = width;\n        this.height = height;\n        \n        this.aspect.x = Math.max(this.width / this.height, 1);\n        this.aspect.y = Math.max(this.height / this.width, 1);\n        \n        this.tile.pixelWidth = (this.width / (SCALE_1_COUNT * this.aspect.y)) * this.zoom;\n        this.tile.pixelHeight = (this.height / (SCALE_1_COUNT * this.aspect.x)) * this.zoom;\n\n        this.canvas.forEach(c => c.update(this));\n    }\n    \n    updateZoom = (zoom) => {\n        \n        this.zoom = zoom;\n\n        this.tile.pixelWidth = (this.width / (SCALE_1_COUNT * this.aspect.y)) * this.zoom;\n        this.tile.pixelHeight = (this.height / (SCALE_1_COUNT * this.aspect.x)) * this.zoom;\n        \n        this.canvas.forEach(c => c.update(this));\n        window.requestAnimationFrame(this.redraw);\n    }\n   \n    translate = (dX, dY) => {\n    \n        this.center= { x: this.center.x + dX, y: this.center.y + dY};\n\n        this.canvas.forEach(c => c.update(this));\n        window.requestAnimationFrame(this.redraw);\n    }\n\n    redraw = () => {\n        this.canvas2d.drawScene();\n        this.canvas3d.drawScene(this.objects3d, this);\n    }\n    \n    draw = () => {\n        this.canvas.forEach(c => c.draw());\n        this.redraw();\n    }\n}\n\n","import React, { Component, Fragment } from 'react';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport { AppBar, Toolbar, Link, Typography, CircularProgress } from '@material-ui/core';\nimport { Mouse, Keyboard, Touch } from './input';\n\nimport Scene from './Scene';\n\nconst styles = theme => ({\n    container: {\n        position: 'relative',\n    },\n    canvas3d: {\n        display: 'block',\n    },\n    canvas2d: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        zIndex: 10,\n    },\n    appBar: {\n        backgroundColor: '#4caf50',\n    },\n    error: {\n        padding: theme.spacing(3, 4),\n    },\n    help: {\n        position: 'absolute',\n        bottom: 5,\n        right: 85,\n        backgroundColor: '#eaeaeaff',\n        padding: 5,\n        borderRadius: 5,\n        fontSize: 15,\n        fontWeight: 300,\n        color: '#1a1a1aff',\n        marginLeft: 45,\n    },\n    progress: {\n        position: 'absolute',\n        left: '46vw',\n        top: '40vh',\n        color: '#ffc107',\n        zIndex: 30,\n    }\n});     \n        \nclass Explorer extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.scene = new Scene();\n        \n        this.input = {\n            keyboard: new Keyboard(this.scene),\n            touch: new Touch(this.scene),\n            mouse: new Mouse(this.scene),\n        };\n        \n        this.state = {\n            pixelWidth: window.innerWidth,\n            pixelHeight: window.innerHeight, \n            initialized: false,\n            error: false,\n        };\n    }\n    \n    componentDidMount() {\n\n        this.updateCanvasSize().then(() => {\n\n            return this.scene.initialize(this.refs.canvas2d, this.refs.canvas3d);\n            \n        }).then(() => {\n\n            this.scene.updateSize(this.state.pixelWidth, this.state.pixelHeight);\n\n            window.addEventListener(\"orientationchange\", this.chromeWorkaround);            \n            window.addEventListener(\"resize\", this.handleResize);            \n\n            this.input.mouse.bind(this.refs.canvas2d);\n            this.input.touch.bind(this.refs.canvas2d);\n            this.input.keyboard.bind(this.refs.canvas2d);    \n            \n            this.setState({\n                initialized: true,\n \n            }, () => {\n                window.requestAnimationFrame(this.scene.draw);                                             \n            });\n                        \n        }).catch(error => {\n            this.setState({\n                error: error,\n            });                        \n        })\n    }\n    \n    componentWillUnmount() {\n        if (this.state.initialized) {\n            window.removeEventListener(\"resize\", this.handleResize);\n            window.removeEventListener(\"orientationchange\", this.chromeWorkaround);        \n    \n            this.input.keyboard.unbind();\n            this.input.touch.unbind();        \n            this.input.mouse.unbind();\n        }\n    }\n    \n    handleResize = () => {\n        if (this.resizeTimeout) {\n            clearTimeout(this.resizeTimeout);\n        }\n\n        this.resizeTimeout = setTimeout(this.updateDimensions, 125);\n    }\n    \n    updateDimensions = () => {\n        this.updateCanvasSize().then(() => {                \n            this.scene.updateSize(this.state.pixelWidth, this.state.pixelHeight);\n            window.requestAnimationFrame(this.scene.draw);                \n\n        });\n    }\n    \n    updateCanvasSize = async () => {\n        return new Promise((resolve) => {\n            \n            const pixelWidth = window.innerWidth -1;\n            const pixelHeight = window.innerHeight -65;\n\n            this.setState({\n                pixelWidth: pixelWidth,\n                pixelHeight: pixelHeight, \n                \n            }, () => {                \n                resolve();    \n            });        \n        });\n    }\n    \n    chromeWorkaround = () => {\n        this.refs.canvas2d.width = 1;\n        this.refs.canvas2d.height = 1;\n        this.refs.canvas3d.width = 1;\n        this.refs.canvas3d.height = 1;\n    }\n\n    render() {\n        const { classes } = this.props;\n\n        return (<Fragment>\n                    <AppBar position=\"static\" className={classes.appBar}>\n                        <Toolbar>\n                            <Link className={classes.title}\n                                variant=\"h6\"\n                                underline=\"none\"\n                                component=\"a\"\n                                href=\"https://en.wikipedia.org/wiki/Maurer_rose\" target=\"_blank\"\n                                color=\"inherit\"\n                                >\n                                Maurer Rose Explorer\n                            </Link>\n                        </Toolbar>\n                    </AppBar>\n                    {(!this.state.error && !this.state.initialized) &&\n                    <CircularProgress color=\"secondary\" className={classes.progress}\n                        disableShrink\n                        size={80}\n                        thickness={6}\n                        />\n                    }\n                    {this.state.error &&\n\n                        <Typography color=\"error\" display=\"block\" gutterBottom={true} paragraph={true} align=\"left\"\n                        className={classes.error}\n                        >\n                            {this.state.error} Please use latest Chrome or Firefox.\n                        </Typography>\n\n                    }\n                    {(!this.state.error) &&\n                        (<div className={classes.container} ref=\"container\">                  \n                            <canvas ref=\"canvas3d\"\n                                className={classes.canvas3d}\n                                width={this.state.pixelWidth}\n                                height={this.state.pixelHeight}                        \n                                />\n                            <canvas ref=\"canvas2d\" \n                                className={classes.canvas2d}\n                                width={this.state.pixelWidth}\n                                height={this.state.pixelHeight}                                                \n                                />\n                            {this.state.initialized &&\n                                <div className={classes.help} ref=\"help\" >\n                                    use a mouse or gestures to move and zoom \n                                </div>\n                            }\n                        </div>)\n                    } \n                </Fragment>\n                );\n    }\n}\n\nexport default withStyles(styles)(Explorer);","import React from 'react';\nimport './App.css';\n\nimport Explorer from './Explorer';\n\nimport CssBaseline from '@material-ui/core/CssBaseline';\n\n\nfunction App() {\n  return (\n      <React.Fragment>\n        <CssBaseline />        \n        <div className=\"App\">\n            <Explorer />\n        </div>\n        </React.Fragment>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}